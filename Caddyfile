# Bridge Discussion App - Host Caddy Configuration
{$DOMAIN} {
    # API endpoints
    handle /api/* {
        reverse_proxy localhost:3001
    }

    # Bridge hand viewer
    handle /viewer/* {
        reverse_proxy localhost:3002
    }

    # Uploads
    handle /uploads/* {
        root {$APP_ROOT}/backend
        file_server
        header Access-Control-Allow-Origin *
    }

    # Frontend static files
    handle {
        root {$APP_ROOT}/frontend/dist
        try_files {path} {path}/ /index.html
        file_server
    }

    # Basic security headers
    header {
        X-Frame-Options SAMEORIGIN
        X-Content-Type-Options nosniff
        -Server
    }

    encode gzip
}