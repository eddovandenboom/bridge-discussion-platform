# Bridge Discussion App - Host Caddy Configuration

:80 {

    # API endpoints
    handle /api/* {
        reverse_proxy backend:3001
    }

    # Bridge hand viewer
    handle /viewer/* {
        uri strip_prefix /viewer
        reverse_proxy bridge-viewer:3002
    }

    # Uploads
    handle /uploads/* {
        root /app/uploads
        file_server
        header Access-Control-Allow-Origin *
    }

    # Frontend static files
    handle {
        reverse_proxy frontend:3000
    }

    # Basic security headers
    header {
        X-Frame-Options SAMEORIGIN
        X-Content-Type-Options nosniff
        -Server
    }

    encode gzip
}